!function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=7)}([function(e,t,n){"use strict";function r(){}function o(e,t){var n,o,i,a,u=U;for(a=arguments.length;a-- >2;)T.push(arguments[a]);for(t&&null!=t.children&&(T.length||T.push(t.children),delete t.children);T.length;)if((o=T.pop())&&void 0!==o.pop)for(a=o.length;a--;)T.push(o[a]);else"boolean"==typeof o&&(o=null),(i="function"!=typeof e)&&(null==o?o="":"number"==typeof o?o=String(o):"string"!=typeof o&&(i=!1)),i&&n?u[u.length-1]+=o:u===U?u=[o]:u.push(o),n=i;var l=new r;return l.nodeName=e,l.children=u,l.attributes=null==t?void 0:t,l.key=null==t?void 0:t.key,void 0!==R.vnode&&R.vnode(l),l}function i(e,t){for(var n in t)e[n]=t[n];return e}function a(e,t){return o(e.nodeName,i(i({},e.attributes),t),arguments.length>2?[].slice.call(arguments,2):e.children)}function u(e){!e._dirty&&(e._dirty=!0)&&1==B.push(e)&&(R.debounceRendering||L)(l)}function l(){var e,t=B;for(B=[];e=t.pop();)e._dirty&&k(e)}function c(e,t,n){return"string"==typeof t||"number"==typeof t?void 0!==e.splitText:"string"==typeof t.nodeName?!e._componentConstructor&&s(e,t.nodeName):n||e._componentConstructor===t.nodeName}function s(e,t){return e.normalizedNodeName===t||e.nodeName.toLowerCase()===t.toLowerCase()}function f(e){var t=i({},e.attributes);t.children=e.children;var n=e.nodeName.defaultProps;if(void 0!==n)for(var r in n)void 0===t[r]&&(t[r]=n[r]);return t}function d(e,t){var n=t?document.createElementNS("http://www.w3.org/2000/svg",e):document.createElement(e);return n.normalizedNodeName=e,n}function p(e){var t=e.parentNode;t&&t.removeChild(e)}function y(e,t,n,r,o){if("className"===t&&(t="class"),"key"===t);else if("ref"===t)n&&n(null),r&&r(e);else if("class"!==t||o)if("style"===t){if(r&&"string"!=typeof r&&"string"!=typeof n||(e.style.cssText=r||""),r&&"object"==typeof r){if("string"!=typeof n)for(var i in n)i in r||(e.style[i]="");for(var i in r)e.style[i]="number"==typeof r[i]&&!1===A.test(i)?r[i]+"px":r[i]}}else if("dangerouslySetInnerHTML"===t)r&&(e.innerHTML=r.__html||"");else if("o"==t[0]&&"n"==t[1]){var a=t!==(t=t.replace(/Capture$/,""));t=t.toLowerCase().substring(2),r?n||e.addEventListener(t,b,a):e.removeEventListener(t,b,a),(e._listeners||(e._listeners={}))[t]=r}else if("list"!==t&&"type"!==t&&!o&&t in e)h(e,t,null==r?"":r),null!=r&&!1!==r||e.removeAttribute(t);else{var u=o&&t!==(t=t.replace(/^xlink\:?/,""));null==r||!1===r?u?e.removeAttributeNS("http://www.w3.org/1999/xlink",t.toLowerCase()):e.removeAttribute(t):"function"!=typeof r&&(u?e.setAttributeNS("http://www.w3.org/1999/xlink",t.toLowerCase(),r):e.setAttribute(t,r))}else e.className=r||""}function h(e,t,n){try{e[t]=n}catch(e){}}function b(e){return this._listeners[e.type](R.event&&R.event(e)||e)}function v(){for(var e;e=D.pop();)R.afterMount&&R.afterMount(e),e.componentDidMount&&e.componentDidMount()}function g(e,t,n,r,o,i){W++||(q=null!=o&&void 0!==o.ownerSVGElement,$=null!=e&&!("__preactattr_"in e));var a=m(e,t,n,r,i);return o&&a.parentNode!==o&&o.appendChild(a),--W||($=!1,i||v()),a}function m(e,t,n,r,o){var i=e,a=q;if(null!=t&&"boolean"!=typeof t||(t=""),"string"==typeof t||"number"==typeof t)return e&&void 0!==e.splitText&&e.parentNode&&(!e._component||o)?e.nodeValue!=t&&(e.nodeValue=t):(i=document.createTextNode(t),e&&(e.parentNode&&e.parentNode.replaceChild(i,e),O(e,!0))),i.__preactattr_=!0,i;var u=t.nodeName;if("function"==typeof u)return I(e,t,n,r);if(q="svg"===u||"foreignObject"!==u&&q,u=String(u),(!e||!s(e,u))&&(i=d(u,q),e)){for(;e.firstChild;)i.appendChild(e.firstChild);e.parentNode&&e.parentNode.replaceChild(i,e),O(e,!0)}var l=i.firstChild,c=i.__preactattr_,f=t.children;if(null==c){c=i.__preactattr_={};for(var p=i.attributes,y=p.length;y--;)c[p[y].name]=p[y].value}return!$&&f&&1===f.length&&"string"==typeof f[0]&&null!=l&&void 0!==l.splitText&&null==l.nextSibling?l.nodeValue!=f[0]&&(l.nodeValue=f[0]):(f&&f.length||null!=l)&&_(i,f,n,r,$||null!=c.dangerouslySetInnerHTML),j(i,t.attributes,c),q=a,i}function _(e,t,n,r,o){var i,a,u,l,s,f=e.childNodes,d=[],y={},h=0,b=0,v=f.length,g=0,_=t?t.length:0;if(0!==v)for(var w=0;w<v;w++){var j=f[w],x=j.__preactattr_,P=_&&x?j._component?j._component.__key:x.key:null;null!=P?(h++,y[P]=j):(x||(void 0!==j.splitText?!o||j.nodeValue.trim():o))&&(d[g++]=j)}if(0!==_)for(var w=0;w<_;w++){l=t[w],s=null;var P=l.key;if(null!=P)h&&void 0!==y[P]&&(s=y[P],y[P]=void 0,h--);else if(!s&&b<g)for(i=b;i<g;i++)if(void 0!==d[i]&&c(a=d[i],l,o)){s=a,d[i]=void 0,i===g-1&&g--,i===b&&b++;break}s=m(s,l,n,r),u=f[w],s&&s!==e&&s!==u&&(null==u?e.appendChild(s):s===u.nextSibling?p(u):e.insertBefore(s,u))}if(h)for(var w in y)void 0!==y[w]&&O(y[w],!1);for(;b<=g;)void 0!==(s=d[g--])&&O(s,!1)}function O(e,t){var n=e._component;n?E(n):(null!=e.__preactattr_&&e.__preactattr_.ref&&e.__preactattr_.ref(null),!1!==t&&null!=e.__preactattr_||p(e),w(e))}function w(e){for(e=e.lastChild;e;){var t=e.previousSibling;O(e,!0),e=t}}function j(e,t,n){var r;for(r in n)t&&null!=t[r]||null==n[r]||y(e,r,n[r],n[r]=void 0,q);for(r in t)"children"===r||"innerHTML"===r||r in n&&t[r]===("value"===r||"checked"===r?e[r]:n[r])||y(e,r,n[r],n[r]=t[r],q)}function x(e){var t=e.constructor.name;(z[t]||(z[t]=[])).push(e)}function P(e,t,n){var r,o=z[e.name];if(e.prototype&&e.prototype.render?(r=new e(t,n),M.call(r,t,n)):(r=new M(t,n),r.constructor=e,r.render=S),o)for(var i=o.length;i--;)if(o[i].constructor===e){r.nextBase=o[i].nextBase,o.splice(i,1);break}return r}function S(e,t,n){return this.constructor(e,n)}function C(e,t,n,r,o){e._disable||(e._disable=!0,(e.__ref=t.ref)&&delete t.ref,(e.__key=t.key)&&delete t.key,!e.base||o?e.componentWillMount&&e.componentWillMount():e.componentWillReceiveProps&&e.componentWillReceiveProps(t,r),r&&r!==e.context&&(e.prevContext||(e.prevContext=e.context),e.context=r),e.prevProps||(e.prevProps=e.props),e.props=t,e._disable=!1,0!==n&&(1!==n&&!1===R.syncComponentUpdates&&e.base?u(e):k(e,1,o)),e.__ref&&e.__ref(e))}function k(e,t,n,r){if(!e._disable){var o,a,u,l=e.props,c=e.state,s=e.context,d=e.prevProps||l,p=e.prevState||c,y=e.prevContext||s,h=e.base,b=e.nextBase,m=h||b,_=e._component,w=!1;if(h&&(e.props=d,e.state=p,e.context=y,2!==t&&e.shouldComponentUpdate&&!1===e.shouldComponentUpdate(l,c,s)?w=!0:e.componentWillUpdate&&e.componentWillUpdate(l,c,s),e.props=l,e.state=c,e.context=s),e.prevProps=e.prevState=e.prevContext=e.nextBase=null,e._dirty=!1,!w){o=e.render(l,c,s),e.getChildContext&&(s=i(i({},s),e.getChildContext()));var j,x,S=o&&o.nodeName;if("function"==typeof S){var I=f(o);a=_,a&&a.constructor===S&&I.key==a.__key?C(a,I,1,s,!1):(j=a,e._component=a=P(S,I,s),a.nextBase=a.nextBase||b,a._parentComponent=e,C(a,I,0,s,!1),k(a,1,n,!0)),x=a.base}else u=m,j=_,j&&(u=e._component=null),(m||1===t)&&(u&&(u._component=null),x=g(u,o,s,n||!h,m&&m.parentNode,!0));if(m&&x!==m&&a!==_){var M=m.parentNode;M&&x!==M&&(M.replaceChild(x,m),j||(m._component=null,O(m,!1)))}if(j&&E(j),e.base=x,x&&!r){for(var N=e,T=e;T=T._parentComponent;)(N=T).base=x;x._component=N,x._componentConstructor=N.constructor}}if(!h||n?D.unshift(e):w||(e.componentDidUpdate&&e.componentDidUpdate(d,p,y),R.afterUpdate&&R.afterUpdate(e)),null!=e._renderCallbacks)for(;e._renderCallbacks.length;)e._renderCallbacks.pop().call(e);W||r||v()}}function I(e,t,n,r){for(var o=e&&e._component,i=o,a=e,u=o&&e._componentConstructor===t.nodeName,l=u,c=f(t);o&&!l&&(o=o._parentComponent);)l=o.constructor===t.nodeName;return o&&l&&(!r||o._component)?(C(o,c,3,n,r),e=o.base):(i&&!u&&(E(i),e=a=null),o=P(t.nodeName,c,n),e&&!o.nextBase&&(o.nextBase=e,a=null),C(o,c,1,n,r),e=o.base,a&&e!==a&&(a._component=null,O(a,!1))),e}function E(e){R.beforeUnmount&&R.beforeUnmount(e);var t=e.base;e._disable=!0,e.componentWillUnmount&&e.componentWillUnmount(),e.base=null;var n=e._component;n?E(n):t&&(t.__preactattr_&&t.__preactattr_.ref&&t.__preactattr_.ref(null),e.nextBase=t,p(t),x(e),w(t)),e.__ref&&e.__ref(null)}function M(e,t){this._dirty=!0,this.context=t,this.props=e,this.state=this.state||{}}function N(e,t,n){return g(n,e,{},!1,t,!1)}Object.defineProperty(t,"__esModule",{value:!0}),n.d(t,"h",function(){return o}),n.d(t,"createElement",function(){return o}),n.d(t,"cloneElement",function(){return a}),n.d(t,"Component",function(){return M}),n.d(t,"render",function(){return N}),n.d(t,"rerender",function(){return l}),n.d(t,"options",function(){return R});var R={},T=[],U=[],L="function"==typeof Promise?Promise.resolve().then.bind(Promise.resolve()):setTimeout,A=/acit|ex(?:s|g|n|p|$)|rph|ows|mnc|ntw|ine[ch]|zoo|^ord/i,B=[],D=[],W=0,q=!1,$=!1,z={};i(M.prototype,{setState:function(e,t){var n=this.state;this.prevState||(this.prevState=i({},n)),i(n,"function"==typeof e?e(n,this.props):e),t&&(this._renderCallbacks=this._renderCallbacks||[]).push(t),u(this)},forceUpdate:function(e){e&&(this._renderCallbacks=this._renderCallbacks||[]).push(e),k(this,2)},render:function(){}}),t.default={h:o,createElement:o,cloneElement:a,Component:M,render:N,rerender:l,options:R}},function(e,t){"use strict";function n(e,t){return function(){t&&(t={detail:t});var n=new CustomEvent(e,t);document.dispatchEvent(n)}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=n},function(e,t,n){"use strict";function r(e,t){for(var n in t)e[n]=t[n];return e}function o(e,t,n){void 0===n&&(n=O);var r,o=/(?:\?([^#]*))?(#.*)?$/,i=e.match(o),u={};if(i&&i[1])for(var l=i[1].split("&"),c=0;c<l.length;c++){var s=l[c].split("=");u[decodeURIComponent(s[0])]=decodeURIComponent(s.slice(1).join("="))}e=a(e.replace(o,"")),t=a(t||"");for(var f=Math.max(e.length,t.length),d=0;d<f;d++)if(t[d]&&":"===t[d].charAt(0)){var p=t[d].replace(/(^\:|[+*?]+$)/g,""),y=(t[d].match(/[+*?]+$/)||O)[0]||"",h=~y.indexOf("+"),b=~y.indexOf("*"),v=e[d]||"";if(!v&&!b&&(y.indexOf("?")<0||h)){r=!1;break}if(u[p]=decodeURIComponent(v),h||b){u[p]=e.slice(d).map(decodeURIComponent).join("/");break}}else if(t[d]!==e[d]){r=!1;break}return(!0===n.default||!1!==r)&&u}function i(e,t){var n=e.attributes||O,r=t.attributes||O;return n.default?1:r.default?-1:u(n.path)-u(r.path)||n.path.length-r.path.length}function a(e){return l(e).split("/")}function u(e){return(l(e).match(/\/+/g)||"").length}function l(e){return e.replace(/(^\/+|\/+$)/g,"")}function c(e){return null!=e.__preactattr_||"undefined"!=typeof Symbol&&null!=e[Symbol.for("preactattr")]}function s(e,t){void 0===t&&(t="push"),w&&w[t]?w[t](e):"undefined"!=typeof history&&history[t+"State"]&&history[t+"State"](null,null,e)}function f(){var e;return e=w&&w.location?w.location:w&&w.getCurrentLocation?w.getCurrentLocation():"undefined"!=typeof location?location:P,""+(e.pathname||"")+(e.search||"")}function d(e,t){return void 0===t&&(t=!1),"string"!=typeof e&&e.url&&(t=e.replace,e=e.url),p(e)&&s(e,t?"replace":"push"),y(e)}function p(e){for(var t=j.length;t--;)if(j[t].canRoute(e))return!0;return!1}function y(e){for(var t=!1,n=0;n<j.length;n++)!0===j[n].routeTo(e)&&(t=!0);for(var r=x.length;r--;)x[r](e);return t}function h(e){if(e&&e.getAttribute){var t=e.getAttribute("href"),n=e.getAttribute("target");if(t&&t.match(/^\//g)&&(!n||n.match(/^_?self$/i)))return d(t)}}function b(e){if(0==e.button)return h(e.currentTarget||e.target||this),v(e)}function v(e){return e&&(e.stopImmediatePropagation&&e.stopImmediatePropagation(),e.stopPropagation&&e.stopPropagation(),e.preventDefault()),!1}function g(e){if(!(e.ctrlKey||e.metaKey||e.altKey||e.shiftKey||0!==e.button)){var t=e.target;do{if("A"===String(t.nodeName).toUpperCase()&&t.getAttribute("href")&&c(t)){if(t.hasAttribute("native"))return;if(h(t))return v(e)}}while(t=t.parentNode)}}function m(){S||("function"==typeof addEventListener&&(w||addEventListener("popstate",function(){return y(f())}),addEventListener("click",g)),S=!0)}Object.defineProperty(t,"__esModule",{value:!0}),n.d(t,"subscribers",function(){return x}),n.d(t,"getCurrentUrl",function(){return f}),n.d(t,"route",function(){return d}),n.d(t,"Router",function(){return C}),n.d(t,"Route",function(){return I}),n.d(t,"Link",function(){return k});var _=n(0),O={},w=null,j=[],x=[],P={},S=!1,C=function(e){function t(t){e.call(this,t),t.history&&(w=t.history),this.state={url:t.url||f()},m()}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.shouldComponentUpdate=function(e){return!0!==e.static||(e.url!==this.props.url||e.onChange!==this.props.onChange)},t.prototype.canRoute=function(e){return this.getMatchingChildren(this.props.children,e,!1).length>0},t.prototype.routeTo=function(e){return this._didRoute=!1,this.setState({url:e}),this.updating?this.canRoute(e):(this.forceUpdate(),this._didRoute)},t.prototype.componentWillMount=function(){j.push(this),this.updating=!0},t.prototype.componentDidMount=function(){var e=this;w&&(this.unlisten=w.listen(function(t){e.routeTo(""+(t.pathname||"")+(t.search||""))})),this.updating=!1},t.prototype.componentWillUnmount=function(){"function"==typeof this.unlisten&&this.unlisten(),j.splice(j.indexOf(this),1)},t.prototype.componentWillUpdate=function(){this.updating=!0},t.prototype.componentDidUpdate=function(){this.updating=!1},t.prototype.getMatchingChildren=function(e,t,n){return e.slice().sort(i).map(function(e){var i=e.attributes||{},a=i.path,u=o(t,a,i);if(u){if(!1!==n){var l={url:t,matches:u};return r(l,u),Object(_.cloneElement)(e,l)}return e}return!1}).filter(Boolean)},t.prototype.render=function(e,t){var n=e.children,r=e.onChange,o=t.url,i=this.getMatchingChildren(n,o,!0),a=i[0]||null;this._didRoute=!!a;var u=this.previousUrl;return o!==u&&(this.previousUrl=o,"function"==typeof r&&r({router:this,url:o,previous:u,active:i,current:a})),a},t}(_.Component),k=function(e){return Object(_.h)("a",r({onClick:b},e))},I=function(e){return Object(_.h)(e.component,e)};C.subscribers=x,C.getCurrentUrl=f,C.route=d,C.Router=C,C.Route=I,C.Link=k,t.default=C},function(e,t,n){"use strict";function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(0);t.default=function(e){function t(){return r(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return o(t,e),i(t,[{key:"render",value:function(){return(0,a.h)("h2",null,"Looks like that doesn't exist!")}}]),t}(a.Component)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(16),o=function(e){return e&&e.__esModule?e:{default:e}}(r);t.default=function(){var e=!!o.default.get("logged_in");return e||localStorage.clear(),{entryReady:!1,loggedIn:e,loading:0,syncing:0,entryIndex:-1,entry:void 0,entries:JSON.parse(localStorage.getItem("entries"))||void 0}}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return t=t||{},t.credentials="same-origin",t.headers=new Headers({"Content-Type":"application/json",Accept:"application/json"}),t.body&&(t.body=JSON.stringify(t.body)),fetch(e,t).then(function(e){return e.status>=300?Promise.reject(e):204===e.status?Promise.resolve():Promise.resolve(e.json())})}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e,t){return t.map(function(e){return e.id}).indexOf(e)},r=function(e,t){return t.splice(e,1),t};t.findObjectIndexById=n,t.removeObjectByIndex=r},function(e,t,n){"use strict";var r=n(0),o=n(8);(0,r.render)((0,r.h)(function(e){return e&&e.__esModule?e:{default:e}}(o).default,null),document.body)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(0),l=n(2),c=n(9),s=r(c),f=n(11),d=r(f),p=n(12),y=r(p),h=n(14),b=r(h),v=n(3),g=r(v),m=n(15),_=r(m),O=n(4),w=r(O),j=n(17),x=r(j),P=n(1),S=r(P),C=n(24);t.default=function(e){function t(){for(var e,n,r,i,a=arguments.length,u=Array(a),l=0;l<a;l++)u[l]=arguments[l];return n=r=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(u))),r.state=(0,w.default)(),i=n,o(r,i)}return i(t,e),a(t,[{key:"componentWillMount",value:function(){(0,_.default)(this,x.default),(0,S.default)("getEntries")(),window.app=this,window.route=l.route}},{key:"componentWillUpdate",value:function(){(0,S.default)("getEntries")()}},{key:"render",value:function(e,t){var n=t.loggedIn,r=t.loading,o=t.entryIndex,i=t.entry,a=t.entries,c=t.entryReady;return(0,u.h)("div",{id:"main-wrapper"},(0,u.h)("div",{id:"view-wrapper"},(0,u.h)("main",{id:"main"},(0,u.h)(s.default,null),(0,u.h)(l.Router,{onChange:C.handleRouteChange.bind(this)},(0,u.h)(d.default,{path:"/",loggedIn:n,loading:r}),(0,u.h)(y.default,{path:"/entries",loggedIn:n,loading:r,entries:a}),(0,u.h)(b.default,{path:"/entry/:id",loggedIn:n,loading:r,entryIndex:o,entry:i,entryReady:c}),(0,u.h)(g.default,{default:!0})))))}}]),t}(u.Component)},function(e,t,n){"use strict";function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(0),u=n(10),l=n(1),c=function(e){return e&&e.__esModule?e:{default:e}}(l);t.default=function(e){function t(){return r(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return o(t,e),i(t,[{key:"render",value:function(){return(0,a.h)("header",null,(0,a.h)("h1",null,"Journalize"),(0,a.h)("nav",null,(0,a.h)(u.Link,{href:"/entries"},"Entries"),(0,a.h)(u.Link,{href:"/entry/new"},"Create"),(0,a.h)(u.Link,{href:"#",onClick:(0,c.default)("logout")},"Logout")))}}]),t}(a.Component)},function(e,t,n){"use strict";function r(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Link=t.Match=void 0;var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},u=n(0),l=n(2),c=t.Match=function(e){function t(){for(var t,n,r,i=arguments.length,a=Array(i),u=0;u<i;u++)a[u]=arguments[u];return t=n=o(this,e.call.apply(e,[this].concat(a))),n.update=function(e){n.nextUrl=e,n.setState({})},r=t,o(n,r)}return i(t,e),t.prototype.componentDidMount=function(){l.subscribers.push(this.update)},t.prototype.componentWillUnmount=function(){l.subscribers.splice(l.subscribers.indexOf(this.update)>>>0,1)},t.prototype.render=function(e){var t=this.nextUrl||(0,l.getCurrentUrl)(),n=t.replace(/\?.+$/,"");return this.nextUrl=null,e.children[0]&&e.children[0]({url:t,path:n,matches:n===e.path})},t}(u.Component),s=function(e){var t=e.activeClassName,n=e.path,o=r(e,["activeClassName","path"]);return(0,u.h)(c,{path:n||o.href},function(e){var n=e.matches;return(0,u.h)(l.Link,a({},o,{class:[o.class||o.className,n&&t].filter(Boolean).join(" ")}))})};t.Link=s,t.default=c,c.Link=s},function(e,t,n){"use strict";function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(0),u=n(1),l=function(e){return e&&e.__esModule?e:{default:e}}(u);t.default=function(e){function t(){for(var e,n,o,i,a=arguments.length,u=Array(a),c=0;c<a;c++)u[c]=arguments[c];return n=o=r(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(u))),o.join=function(e){e.preventDefault(),(0,l.default)("createAccount",{user:{username:o.base.querySelector("#cusername").value,password:o.base.querySelector("#cpassword").value}})()},o.login=function(e){e.preventDefault(),(0,l.default)("login",{user:{username:o.base.querySelector("#lusername").value,password:o.base.querySelector("#lpassword").value}})()},i=n,r(o,i)}return o(t,e),i(t,[{key:"render",value:function(){return(0,a.h)("div",{class:"login-page-wrapper"},(0,a.h)("h1",{class:"center-text"},"Journalize"),(0,a.h)("h4",{class:"center-text"},"Private and public journal entries"),(0,a.h)("form",{action:"javscript:",onSubmit:this.join,class:"join-form pure-form pure-form-stacked full-width"},(0,a.h)("fieldset",null,(0,a.h)("legend",null,"Create an Account"),(0,a.h)("input",{id:"cusername",placeholder:"username",autocapitalize:"off"}),(0,a.h)("input",{id:"cpassword",type:"password",placeholder:"password"}),(0,a.h)("input",{type:"submit",class:"pure-button pure-button-primary"}))),(0,a.h)("form",{action:"javascript:",onSubmit:this.login,class:"login-form pure-form pure-form-stacked full-width"},(0,a.h)("fieldset",null,(0,a.h)("legend",null,"or Login"),(0,a.h)("input",{id:"lusername",placeholder:"username",autocapitalize:"off"}),(0,a.h)("input",{id:"lpassword",type:"password",placeholder:"password"}),(0,a.h)("input",{type:"submit",class:"pure-button pure-button-primary"}))))}}]),t}(a.Component)},function(e,t,n){"use strict";function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(0),u=n(13),l=function(e){return e&&e.__esModule?e:{default:e}}(u);t.default=function(e){function t(){return r(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return o(t,e),i(t,[{key:"render",value:function(e){var t=e.entries;return t=t||[],(0,a.h)("entry-list",null,t.map(function(e){return(0,a.h)(l.default,{entry:e})}))}}]),t}(a.Component)},function(e,t,n){"use strict";function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(0);t.default=function(e){function t(){return r(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return o(t,e),i(t,[{key:"render",value:function(e){var t=e.entry;return t.deleted||t.newEntry&&!t.postPending?"":(0,a.h)("div",{class:"entry-preview"},(0,a.h)("a",{class:"entry-link",href:"/entry/"+t.id},t.date),(0,a.h)("span",null,t.isPublic?"🔓":"🔐"),"✖",(0,a.h)("p",{class:"entry-text"},t.text.length>140?t.text.substr(0,140)+"...":t.text))}}]),t}(a.Component)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(0),l=n(1),c=r(l),s=n(3),f=r(s);t.default=function(e){function t(){for(var e,n,r,i,a=arguments.length,u=Array(a),l=0;l<a;l++)u[l]=arguments[l];return n=r=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(u))),r.upsert=function(e){var t=r.props.entry;t.newEntry?(t.date=r.base.querySelector("#entryDate").innerText,t.text=r.base.querySelector("#entryText").innerText,t.isPublic=r.base.querySelector("#isPublic").checked,(0,c.default)("createEntry",{entry:t})()):r.update(e)},r.update=function(e){var t;switch(e.target.nodeName){case"H1":t="date";break;case"PRE":t="text"}var n={property:t,entryId:r.props.entry.id,entry:{}};n.entry[t]=e.target.innerText,(0,c.default)("updateEntry",n)()},r.togglePublic=function(){var e={property:"isPublic",entryId:r.props.entry.id,entry:{isPublic:r.base.querySelector("#isPublic").checked}};(0,c.default)("updateEntry",e)()},i=n,o(r,i)}return i(t,e),a(t,[{key:"shouldComponentUpdate",value:function(e){var t=this.props.entry,n=e.entry;return!t||!n||(n.date!==t.date||n.text!==t.text.trim()||n.isPublic!==t.isPublic)}},{key:"render",value:function(e){var t=e.entry;if(e.entryReady)return t?(0,u.h)("entry-view",null,(0,u.h)("h1",{id:"entryDate",contenteditable:!0,onInput:this.upsert},t.date),"Public ",(0,u.h)("input",{id:"isPublic",type:"checkbox",onClick:this.togglePublic,checked:t.isPublic}),(0,u.h)("button",{onClick:(0,c.default)("deleteEntry",{id:t.id})},"Delete"),(0,u.h)("pre",{id:"entryText",contenteditable:!0,onInput:this.upsert,class:"entry-text"},t.text)):(0,u.h)(f.default,null)}}]),t}(u.Component)},function(e,t){"use strict";function n(e,t){var n=this;Object.keys(t).forEach(function(r){var o=t[r].bind(n,e);document.addEventListener(r,o)})}Object.defineProperty(t,"__esModule",{value:!0}),t.default=n},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={get:function(e){for(var t=e+"=",n=document.cookie.split(";"),r=0;r<n.length;r++){for(var o=n[r];" "==o.charAt(0);)o=o.substring(1,o.length);if(0==o.indexOf(t))return o.substring(t.length,o.length)}return null}}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(18),i=r(o),a=n(20),u=r(a);t.default=Object.assign(i.default,u.default)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(19),i=r(o),a=n(2),u=n(4),l=r(u),c=function(e){e.setState(Object.assign(e.state,{loggedIn:!0,loading:e.state.loading-1}),function(){(0,a.route)("/entries")})},s=function(e,t){e.setState({loading:e.state.loading-1}),console.log("loginFailure",t)},f=function(e){e.setState({loading:e.state.loading-1}),(0,a.route)("/entries")},d=function(e,t){e.setState({loading:e.state.loading-1}),console.log("createAccountFailure",t)},p=function(e){localStorage.clear(),e.setState((0,l.default)()),(0,a.route)("/")},y=function(e,t){e.setState({loading:e.state.loading-1}),console.log("logoutFailure",t)};t.default={login:function(e,t){localStorage.clear(),e.setState({loading:e.state.loading+1}),i.default.login(t.detail.user).then(function(t){c(e,t)}).catch(function(t){s(e,t)})},createAccount:function(e,t){localStorage.clear(),e.setState({loading:e.state.loading+1}),i.default.create(t.detail.user).then(function(t){f(e,t)}).catch(function(t){d(e,t)})},logout:function(e){e.setState({loading:e.state.loading+1}),i.default.logout().then(function(){p(e)}).catch(function(t){y(e,t)})}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(5),o=function(e){return e&&e.__esModule?e:{default:e}}(r);t.default={create:function(e){return(0,o.default)("/api/user",{method:"POST",body:e})},login:function(e){return(0,o.default)("/api/user/login",{method:"POST",body:e})},logout:function(){return(0,o.default)("/api/user/logout",{method:"POST"})}}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(21),i=r(o),a=n(2),u=n(22),l=r(u),c=n(6),s=n(23),f=r(s),d=!1,p=function(e){if(!e.state.loggedIn)return d=!1;if(!d){d=!0;var t=localStorage.getItem("timestamp");t?g(e,{detail:{timestamp:t}}):y(e)}},y=function(e){e.state.entries||(e.setState({loading:e.state.loading+1}),i.default.getAll().then(function(t){h(e,t)}).catch(function(t){b(e,t)}))},h=function(e,t){(0,f.default)(e,{entries:t.entries,loading:e.state.loading-1},function(){L(e,{detail:{id:e.state.entryId,entryReady:!0}}),localStorage.setItem("timestamp",t.timestamp)})},b=function(e,t){e.setState({loading:e.state.loading-1}),console.log("getAllEntriesError",t)},v=function(e){e.state.entries.forEach(function(t){if(t.needsSync){(t.newEntry?x:t.deleted?R:N)(e,{detail:{id:t.id,entry:t,clientSync:!0}})}})},g=function(e,t){e.setState({loading:e.state.loading+1}),i.default.sync(t.detail.timestamp).then(function(t){m(e,t)}).catch(function(t){w(e,t)}),v(e)},m=function(e,t){if(0===t.entries.length)return e.setState({loading:e.state.loading-1}),void localStorage.setItem("timestamp",t.timestamp);_(e,t.entries),O(e,t.timestamp)},_=function(e,t){t.forEach(function(t){var n=(0,c.findObjectIndexById)(t.id,e.state.entries);n>-1?t.deleted?e.state.entries=(0,c.removeObjectByIndex)(n,e.state.entries):e.state.entries[n]=t:e.state.entries.unshift(t)})},O=function(e,t){(0,f.default)(e,{loading:e.state.loading-1,entries:[].concat(e.state.entries)},function(){"/entry"===e.view&&e.state.entryId&&L(e,{detail:{id:e.state.entryId,entryReady:!0}}),localStorage.setItem("timestamp",t)})},w=function(e,t){e.setState({loading:e.state.loading-1}),console.log("syncEntriesFailure",t)},j=function(){},x=function(e,t){var n=t.detail.entry,r=(0,c.findObjectIndexById)(n.id,e.state.entries);e.state.entries[r]=n,(0,f.default)(e,{loading:e.state.loading+1,entry:n,entries:[].concat(e.state.entries)}),!t.detail.clientSync&&n.postPending||(e.state.entries[r].postPending=!0,(0,f.default)(e,{entries:[].concat(e.state.entries)}),i.default.create(n).then(function(t){S(e,n.id,t)}).catch(function(t){C(e,n.id,t)}))},P=(0,l.default)(x,500),S=function(e,t,n){var r=(0,c.findObjectIndexById)(t,e.state.entries);e.state.entry.id===t&&(e.state.entry.id=n.id),e.state.entries[r].id=n.id,delete e.state.entries[r].postPending,delete e.state.entries[r].newEntry,delete e.state.entries[r].needsSync,(0,f.default)(e,{loading:e.state.loading-1,entry:Object.assign({},e.state.entry),entries:[].concat(e.state.entries)})},C=function(e,t){delete e.state.entries[(0,c.findObjectIndexById)(oldId,e.state.entries)].postPending,e.setState({loading:e.state.loading-1,entries:[].concat(e.state.entries)}),console.log("slowCreateFailure",t)},k=function(e,t){var n=t.detail,r=n.entry[n.property];"string"==typeof r&&(r=r.trim()),n.entry[n.property]=n.entry[n.property];var o=(0,c.findObjectIndexById)(n.entryId,e.state.entries);e.state.entries[o][n.property]!==n.entry[n.property]&&(e.state.entries[o][n.property]=n.entry[n.property],e.state.entries[o].needsSync=!0,(0,f.default)(e,{entry:Object.assign({},e.state.entries[o]),entries:[].concat(e.state.entries)}),i.default.update(n.entryId,n.entry).then(function(){E(e,n.entryId)}).catch(function(t){M(e,t)}))},I=(0,l.default)(k,500),E=function(e,t){var n=(0,c.findObjectIndexById)(t,e.state.entries);delete e.state.entries[n].needsSync,(0,f.default)(e,{entry:Object.assign({},e.state.entries[n]),entries:[].concat(e.state.entries)})},M=function(e,t){console.log("slowUpdateFailure",t)},N=function(e,t){var n=t.detail.entry;i.default.update(n.id,n).then(function(){E(e,n.id)}).catch(function(t){M(e,t)})},R=function(e,t){var n=t.detail.id;if(n){var r=(0,c.findObjectIndexById)(n,e.state.entries);e.state.entries[r].needsSync=!0,e.state.entries[r].deleted=!0,(0,f.default)(e,{entry:void 0,entries:[].concat(e.state.entries)},function(){(0,a.route)("/entries")}),i.default.del(n).then(function(){T(e,n)}).catch(function(t){U(e,t)})}},T=function(e,t){var n=(0,c.findObjectIndexById)(t,e.state.entries);(0,f.default)(e,{entries:(0,c.removeObjectByIndex)(n,e.state.entries)})},U=function(e,t){console.log("deleteEntryFailure",t)},L=function(e,t){if(e.state.entries&&t&&t.detail&&t.detail.id&&-1!==t.detail.id){var n=(0,c.findObjectIndexById)(parseInt(t.detail.id,10),e.state.entries),r=e.state.entries[n];e.setState({entry:r,entryIndex:n,entryReady:!!r||!!t.detail.entryReady})}};t.default={getEntries:p,createEntry:P,getEntry:j,updateEntry:I,deleteEntry:R,setEntry:L,newEntry:function(e){var t={id:Date.now(),date:(new Date).toISOString().slice(0,10),text:"",isPublic:0,needsSync:!0,newEntry:!0};e.setState({entryIndex:0,entries:[t].concat(e.state.entries)},function(){L(e,{detail:{id:t.id,entryReady:!0}})})}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(5),o=function(e){return e&&e.__esModule?e:{default:e}}(r);t.default={create:function(e){return(0,o.default)("/api/entry",{method:"POST",body:e})},get:function(){return(0,o.default)("/api/entry/"+entry.id)},update:function(e,t){return(0,o.default)("/api/entry/"+e,{method:"PATCH",body:t})},del:function(e){return(0,o.default)("/api/entry/"+e,{method:"DELETE"})},getAll:function(){return(0,o.default)("/api/entries")},sync:function(e){return(0,o.default)("/api/entries/sync/"+e)}}},function(e,t){"use strict";function n(e,t,n){var r;return function(){var o=this,i=arguments,a=function(){r=null,n||e.apply(o,i)},u=n&&!r;clearTimeout(r),r=setTimeout(a,t),u&&e.apply(o,i)}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=n},function(e,t){"use strict";function n(e,t,n){e.setState(t,n),t.entries&&localStorage.setItem("entries",JSON.stringify(t.entries))}Object.defineProperty(t,"__esModule",{value:!0}),t.default=n},function(e,t,n){"use strict";function r(e){var t=e.url.lastIndexOf("/")>0?e.url.substr(0,e.url.lastIndexOf("/")):e.url;if(this.view=t,"/"!==t&&!this.state.loggedIn)return route("/");c.call(this,t,e)}Object.defineProperty(t,"__esModule",{value:!0}),t.handleRouteChange=r;var o=n(1),i=function(e){return e&&e.__esModule?e:{default:e}}(o),a=n(6),u=history,l=u.pushState;history.pushState=function(e,t,n){l.call(history,e,t,n),scrollTo(0,0)};var c=function(e,t){switch(e){case"/":s.call(this,t);break;case"/entries":f.call(this,t);break;case"/entry":d.call(this,t)}},s=function(){this.state.loggedIn&&route("/entries")},f=function(){if(Array.isArray(this.state.entries)){var e=this.state.entries[0];e.newEntry&&!e.text&&this.setState({entries:(0,a.removeObjectByIndex)(0,this.state.entries)})}},d=function(e){var t;try{t=e.current.attributes.id}catch(e){}t&&("new"===t?(0,i.default)("newEntry")():(0,i.default)("setEntry",{id:t})())}}]);