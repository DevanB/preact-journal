!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=7)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n.d(t,"h",function(){return a}),n.d(t,"createElement",function(){return a}),n.d(t,"cloneElement",function(){return l}),n.d(t,"Component",function(){return T}),n.d(t,"render",function(){return R}),n.d(t,"rerender",function(){return p}),n.d(t,"options",function(){return r});var r={},o=[],i=[];function a(e,t){var n,a,u,s,l=i;for(s=arguments.length;s-- >2;)o.push(arguments[s]);for(t&&null!=t.children&&(o.length||o.push(t.children),delete t.children);o.length;)if((a=o.pop())&&void 0!==a.pop)for(s=a.length;s--;)o.push(a[s]);else"boolean"==typeof a&&(a=null),(u="function"!=typeof e)&&(null==a?a="":"number"==typeof a?a=String(a):"string"!=typeof a&&(u=!1)),u&&n?l[l.length-1]+=a:l===i?l=[a]:l.push(a),n=u;var c=new function(){};return c.nodeName=e,c.children=l,c.attributes=null==t?void 0:t,c.key=null==t?void 0:t.key,void 0!==r.vnode&&r.vnode(c),c}function u(e,t){for(var n in t)e[n]=t[n];return e}var s="function"==typeof Promise?Promise.resolve().then.bind(Promise.resolve()):setTimeout;function l(e,t){return a(e.nodeName,u(u({},e.attributes),t),arguments.length>2?[].slice.call(arguments,2):e.children)}var c=/acit|ex(?:s|g|n|p|$)|rph|ows|mnc|ntw|ine[ch]|zoo|^ord/i,d=[];function f(e){!e._dirty&&(e._dirty=!0)&&1==d.push(e)&&(r.debounceRendering||s)(p)}function p(){var e,t=d;for(d=[];e=t.pop();)e._dirty&&N(e)}function h(e,t){return e.normalizedNodeName===t||e.nodeName.toLowerCase()===t.toLowerCase()}function y(e){var t=u({},e.attributes);t.children=e.children;var n=e.nodeName.defaultProps;if(void 0!==n)for(var r in n)void 0===t[r]&&(t[r]=n[r]);return t}function v(e){var t=e.parentNode;t&&t.removeChild(e)}function g(e,t,n,r,o){if("className"===t&&(t="class"),"key"===t);else if("ref"===t)n&&n(null),r&&r(e);else if("class"!==t||o)if("style"===t){if(r&&"string"!=typeof r&&"string"!=typeof n||(e.style.cssText=r||""),r&&"object"==typeof r){if("string"!=typeof n)for(var i in n)i in r||(e.style[i]="");for(var i in r)e.style[i]="number"==typeof r[i]&&!1===c.test(i)?r[i]+"px":r[i]}}else if("dangerouslySetInnerHTML"===t)r&&(e.innerHTML=r.__html||"");else if("o"==t[0]&&"n"==t[1]){var a=t!==(t=t.replace(/Capture$/,""));t=t.toLowerCase().substring(2),r?n||e.addEventListener(t,m,a):e.removeEventListener(t,m,a),(e._listeners||(e._listeners={}))[t]=r}else if("list"!==t&&"type"!==t&&!o&&t in e)!function(e,t,n){try{e[t]=n}catch(e){}}(e,t,null==r?"":r),null!=r&&!1!==r||e.removeAttribute(t);else{var u=o&&t!==(t=t.replace(/^xlink\:?/,""));null==r||!1===r?u?e.removeAttributeNS("http://www.w3.org/1999/xlink",t.toLowerCase()):e.removeAttribute(t):"function"!=typeof r&&(u?e.setAttributeNS("http://www.w3.org/1999/xlink",t.toLowerCase(),r):e.setAttribute(t,r))}else e.className=r||""}function m(e){return this._listeners[e.type](r.event&&r.event(e)||e)}var b=[],_=0,x=!1,C=!1;function S(){for(var e;e=b.pop();)r.afterMount&&r.afterMount(e),e.componentDidMount&&e.componentDidMount()}function O(e,t,n,r,o,i){_++||(x=null!=o&&void 0!==o.ownerSVGElement,C=null!=e&&!("__preactattr_"in e));var a=w(e,t,n,r,i);return o&&a.parentNode!==o&&o.appendChild(a),--_||(C=!1,i||S()),a}function w(e,t,n,r,o){var i=e,a=x;if(null!=t&&"boolean"!=typeof t||(t=""),"string"==typeof t||"number"==typeof t)return e&&void 0!==e.splitText&&e.parentNode&&(!e._component||o)?e.nodeValue!=t&&(e.nodeValue=t):(i=document.createTextNode(t),e&&(e.parentNode&&e.parentNode.replaceChild(i,e),P(e,!0))),i.__preactattr_=!0,i;var u,s,l=t.nodeName;if("function"==typeof l)return function(e,t,n,r){var o=e&&e._component,i=o,a=e,u=o&&e._componentConstructor===t.nodeName,s=u,l=y(t);for(;o&&!s&&(o=o._parentComponent);)s=o.constructor===t.nodeName;o&&s&&(!r||o._component)?(E(o,l,3,n,r),e=o.base):(i&&!u&&(U(i),e=a=null),o=M(t.nodeName,l,n),e&&!o.nextBase&&(o.nextBase=e,a=null),E(o,l,1,n,r),e=o.base,a&&e!==a&&(a._component=null,P(a,!1)));return e}(e,t,n,r);if(x="svg"===l||"foreignObject"!==l&&x,l=String(l),(!e||!h(e,l))&&(u=l,(s=x?document.createElementNS("http://www.w3.org/2000/svg",u):document.createElement(u)).normalizedNodeName=u,i=s,e)){for(;e.firstChild;)i.appendChild(e.firstChild);e.parentNode&&e.parentNode.replaceChild(i,e),P(e,!0)}var c=i.firstChild,d=i.__preactattr_,f=t.children;if(null==d){d=i.__preactattr_={};for(var p=i.attributes,m=p.length;m--;)d[p[m].name]=p[m].value}return!C&&f&&1===f.length&&"string"==typeof f[0]&&null!=c&&void 0!==c.splitText&&null==c.nextSibling?c.nodeValue!=f[0]&&(c.nodeValue=f[0]):(f&&f.length||null!=c)&&function(e,t,n,r,o){var i,a,u,s,l,c=e.childNodes,d=[],f={},p=0,y=0,g=c.length,m=0,b=t?t.length:0;if(0!==g)for(var _=0;_<g;_++){var x=c[_],C=x.__preactattr_,S=b&&C?x._component?x._component.__key:C.key:null;null!=S?(p++,f[S]=x):(C||(void 0!==x.splitText?!o||x.nodeValue.trim():o))&&(d[m++]=x)}if(0!==b)for(var _=0;_<b;_++){s=t[_],l=null;var S=s.key;if(null!=S)p&&void 0!==f[S]&&(l=f[S],f[S]=void 0,p--);else if(!l&&y<m)for(i=y;i<m;i++)if(void 0!==d[i]&&(O=a=d[i],I=o,"string"==typeof(j=s)||"number"==typeof j?void 0!==O.splitText:"string"==typeof j.nodeName?!O._componentConstructor&&h(O,j.nodeName):I||O._componentConstructor===j.nodeName)){l=a,d[i]=void 0,i===m-1&&m--,i===y&&y++;break}l=w(l,s,n,r),u=c[_],l&&l!==e&&l!==u&&(null==u?e.appendChild(l):l===u.nextSibling?v(u):e.insertBefore(l,u))}var O,j,I;if(p)for(var _ in f)void 0!==f[_]&&P(f[_],!1);for(;y<=m;)void 0!==(l=d[m--])&&P(l,!1)}(i,f,n,r,C||null!=d.dangerouslySetInnerHTML),function(e,t,n){var r;for(r in n)t&&null!=t[r]||null==n[r]||g(e,r,n[r],n[r]=void 0,x);for(r in t)"children"===r||"innerHTML"===r||r in n&&t[r]===("value"===r||"checked"===r?e[r]:n[r])||g(e,r,n[r],n[r]=t[r],x)}(i,t.attributes,d),x=a,i}function P(e,t){var n=e._component;n?U(n):(null!=e.__preactattr_&&e.__preactattr_.ref&&e.__preactattr_.ref(null),!1!==t&&null!=e.__preactattr_||v(e),j(e))}function j(e){for(e=e.lastChild;e;){var t=e.previousSibling;P(e,!0),e=t}}var I={};function M(e,t,n){var r,o=I[e.name];if(e.prototype&&e.prototype.render?(r=new e(t,n),T.call(r,t,n)):((r=new T(t,n)).constructor=e,r.render=k),o)for(var i=o.length;i--;)if(o[i].constructor===e){r.nextBase=o[i].nextBase,o.splice(i,1);break}return r}function k(e,t,n){return this.constructor(e,n)}function E(e,t,n,o,i){e._disable||(e._disable=!0,(e.__ref=t.ref)&&delete t.ref,(e.__key=t.key)&&delete t.key,!e.base||i?e.componentWillMount&&e.componentWillMount():e.componentWillReceiveProps&&e.componentWillReceiveProps(t,o),o&&o!==e.context&&(e.prevContext||(e.prevContext=e.context),e.context=o),e.prevProps||(e.prevProps=e.props),e.props=t,e._disable=!1,0!==n&&(1!==n&&!1===r.syncComponentUpdates&&e.base?f(e):N(e,1,i)),e.__ref&&e.__ref(e))}function N(e,t,n,o){if(!e._disable){var i,a,s,l=e.props,c=e.state,d=e.context,f=e.prevProps||l,p=e.prevState||c,h=e.prevContext||d,v=e.base,g=e.nextBase,m=v||g,x=e._component,C=!1;if(v&&(e.props=f,e.state=p,e.context=h,2!==t&&e.shouldComponentUpdate&&!1===e.shouldComponentUpdate(l,c,d)?C=!0:e.componentWillUpdate&&e.componentWillUpdate(l,c,d),e.props=l,e.state=c,e.context=d),e.prevProps=e.prevState=e.prevContext=e.nextBase=null,e._dirty=!1,!C){i=e.render(l,c,d),e.getChildContext&&(d=u(u({},d),e.getChildContext()));var w,j,I=i&&i.nodeName;if("function"==typeof I){var k=y(i);(a=x)&&a.constructor===I&&k.key==a.__key?E(a,k,1,d,!1):(w=a,e._component=a=M(I,k,d),a.nextBase=a.nextBase||g,a._parentComponent=e,E(a,k,0,d,!1),N(a,1,n,!0)),j=a.base}else s=m,(w=x)&&(s=e._component=null),(m||1===t)&&(s&&(s._component=null),j=O(s,i,d,n||!v,m&&m.parentNode,!0));if(m&&j!==m&&a!==x){var T=m.parentNode;T&&j!==T&&(T.replaceChild(j,m),w||(m._component=null,P(m,!1)))}if(w&&U(w),e.base=j,j&&!o){for(var R=e,L=e;L=L._parentComponent;)(R=L).base=j;j._component=R,j._componentConstructor=R.constructor}}if(!v||n?b.unshift(e):C||(e.componentDidUpdate&&e.componentDidUpdate(f,p,h),r.afterUpdate&&r.afterUpdate(e)),null!=e._renderCallbacks)for(;e._renderCallbacks.length;)e._renderCallbacks.pop().call(e);_||o||S()}}function U(e){r.beforeUnmount&&r.beforeUnmount(e);var t=e.base;e._disable=!0,e.componentWillUnmount&&e.componentWillUnmount(),e.base=null;var n=e._component;n?U(n):t&&(t.__preactattr_&&t.__preactattr_.ref&&t.__preactattr_.ref(null),e.nextBase=t,v(t),function(e){var t=e.constructor.name;(I[t]||(I[t]=[])).push(e)}(e),j(t)),e.__ref&&e.__ref(null)}function T(e,t){this._dirty=!0,this.context=t,this.props=e,this.state=this.state||{}}function R(e,t,n){return O(n,e,{},!1,t,!1)}u(T.prototype,{setState:function(e,t){var n=this.state;this.prevState||(this.prevState=u({},n)),u(n,"function"==typeof e?e(n,this.props):e),t&&(this._renderCallbacks=this._renderCallbacks||[]).push(t),f(this)},forceUpdate:function(e){e&&(this._renderCallbacks=this._renderCallbacks||[]).push(e),N(this,2)},render:function(){}});var L={h:a,createElement:a,cloneElement:l,Component:T,render:R,rerender:p,options:r};t.default=L},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return function(){t&&(t={detail:t});var n=new CustomEvent(e,t);document.dispatchEvent(n)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n.d(t,"subscribers",function(){return f}),n.d(t,"getCurrentUrl",function(){return h}),n.d(t,"route",function(){return y}),n.d(t,"Router",function(){return C}),n.d(t,"Route",function(){return O}),n.d(t,"Link",function(){return S});var r=n(0),o={};function i(e,t){for(var n in t)e[n]=t[n];return e}function a(e,t){var n=e.attributes||o,r=t.attributes||o;return n.default?1:r.default?-1:s(n.path)-s(r.path)||n.path.length-r.path.length}function u(e){return l(e).split("/")}function s(e){return(l(e).match(/\/+/g)||"").length}function l(e){return e.replace(/(^\/+|\/+$)/g,"")}var c=null,d=[],f=[],p={};function h(){var e;return""+((e=c&&c.location?c.location:c&&c.getCurrentLocation?c.getCurrentLocation():"undefined"!=typeof location?location:p).pathname||"")+(e.search||"")}function y(e,t){return void 0===t&&(t=!1),"string"!=typeof e&&e.url&&(t=e.replace,e=e.url),function(e){for(var t=d.length;t--;)if(d[t].canRoute(e))return!0;return!1}(e)&&function(e,t){void 0===t&&(t="push"),c&&c[t]?c[t](e):"undefined"!=typeof history&&history[t+"State"]&&history[t+"State"](null,null,e)}(e,t?"replace":"push"),v(e)}function v(e){for(var t=!1,n=0;n<d.length;n++)!0===d[n].routeTo(e)&&(t=!0);for(var r=f.length;r--;)f[r](e);return t}function g(e){if(e&&e.getAttribute){var t=e.getAttribute("href"),n=e.getAttribute("target");if(t&&t.match(/^\//g)&&(!n||n.match(/^_?self$/i)))return y(t)}}function m(e){if(0==e.button)return g(e.currentTarget||e.target||this),b(e)}function b(e){return e&&(e.stopImmediatePropagation&&e.stopImmediatePropagation(),e.stopPropagation&&e.stopPropagation(),e.preventDefault()),!1}function _(e){if(!(e.ctrlKey||e.metaKey||e.altKey||e.shiftKey||0!==e.button)){var t,n=e.target;do{if("A"===String(n.nodeName).toUpperCase()&&n.getAttribute("href")&&(null!=(t=n).__preactattr_||"undefined"!=typeof Symbol&&null!=t[Symbol.for("preactattr")])){if(n.hasAttribute("native"))return;if(g(n))return b(e)}}while(n=n.parentNode)}}var x=!1;var C=function(e){function t(t){e.call(this,t),t.history&&(c=t.history),this.state={url:t.url||h()},x||("function"==typeof addEventListener&&(c||addEventListener("popstate",function(){return v(h())}),addEventListener("click",_)),x=!0)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.shouldComponentUpdate=function(e){return!0!==e.static||(e.url!==this.props.url||e.onChange!==this.props.onChange)},t.prototype.canRoute=function(e){return this.getMatchingChildren(this.props.children,e,!1).length>0},t.prototype.routeTo=function(e){return this._didRoute=!1,this.setState({url:e}),this.updating?this.canRoute(e):(this.forceUpdate(),this._didRoute)},t.prototype.componentWillMount=function(){d.push(this),this.updating=!0},t.prototype.componentDidMount=function(){var e=this;c&&(this.unlisten=c.listen(function(t){e.routeTo(""+(t.pathname||"")+(t.search||""))})),this.updating=!1},t.prototype.componentWillUnmount=function(){"function"==typeof this.unlisten&&this.unlisten(),d.splice(d.indexOf(this),1)},t.prototype.componentWillUpdate=function(){this.updating=!0},t.prototype.componentDidUpdate=function(){this.updating=!1},t.prototype.getMatchingChildren=function(e,t,n){return e.slice().sort(a).map(function(e){var a=e.attributes||{},s=a.path,l=function(e,t,n){void 0===n&&(n=o);var r,i=/(?:\?([^#]*))?(#.*)?$/,a=e.match(i),s={};if(a&&a[1])for(var l=a[1].split("&"),c=0;c<l.length;c++){var d=l[c].split("=");s[decodeURIComponent(d[0])]=decodeURIComponent(d.slice(1).join("="))}e=u(e.replace(i,"")),t=u(t||"");for(var f=Math.max(e.length,t.length),p=0;p<f;p++)if(t[p]&&":"===t[p].charAt(0)){var h=t[p].replace(/(^\:|[+*?]+$)/g,""),y=(t[p].match(/[+*?]+$/)||o)[0]||"",v=~y.indexOf("+"),g=~y.indexOf("*"),m=e[p]||"";if(!m&&!g&&(y.indexOf("?")<0||v)){r=!1;break}if(s[h]=decodeURIComponent(m),v||g){s[h]=e.slice(p).map(decodeURIComponent).join("/");break}}else if(t[p]!==e[p]){r=!1;break}return(!0===n.default||!1!==r)&&s}(t,s,a);if(l){if(!1!==n){var c={url:t,matches:l};return i(c,l),Object(r.cloneElement)(e,c)}return e}return!1}).filter(Boolean)},t.prototype.render=function(e,t){var n=e.children,r=e.onChange,o=t.url,i=this.getMatchingChildren(n,o,!0),a=i[0]||null;this._didRoute=!!a;var u=this.previousUrl;return o!==u&&(this.previousUrl=o,"function"==typeof r&&r({router:this,url:o,previous:u,active:i,current:a})),a},t}(r.Component),S=function(e){return Object(r.h)("a",i({onClick:m},e))},O=function(e){return Object(r.h)(e.component,e)};C.subscribers=f,C.getCurrentUrl=h,C.route=y,C.Router=C,C.Route=O,C.Link=S,t.default=C},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=class extends r.Component{render(){return(0,r.h)("h2",null,"Looks like that doesn't exist!")}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o=n(16),i=(r=o)&&r.__esModule?r:{default:r};t.default=function(){let e=!!i.default.get("logged_in");return e||localStorage.clear(),{entryReady:!1,loggedIn:e,loading:0,syncing:0,entryIndex:-1,entry:void 0,entries:JSON.parse(localStorage.getItem("entries"))||void 0}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t={}){return t.credentials="same-origin",t.headers=new Headers({"Content-Type":"application/json",Accept:"application/json"}),t.body&&(t.body=JSON.stringify(t.body)),fetch(e,t).then(e=>e.status>=300?Promise.reject(e):204===e.status?Promise.resolve():Promise.resolve(e.json()))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.findObjectIndexById=function(e,t){return t.map(function(e){return e.id}).indexOf(e)},t.removeObjectByIndex=function(e,t){return t.splice(e,1),t}},function(e,t,n){"use strict";var r,o=n(0),i=n(8),a=(r=i)&&r.__esModule?r:{default:r};(0,o.render)((0,o.h)(a.default,null),document.body)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o=n(2),i=y(n(9)),a=y(n(11)),u=y(n(12)),s=y(n(14)),l=y(n(3)),c=y(n(15)),d=y(n(4)),f=y(n(17)),p=y(n(1)),h=n(24);function y(e){return e&&e.__esModule?e:{default:e}}t.default=class extends r.Component{constructor(...e){var t;return t=super(...e),this.state=(0,d.default)(),t}componentWillMount(){(0,c.default)(this,f.default),(0,p.default)("getEntries")(),window.app=this,window.route=o.route}componentWillUpdate(e,t){(0,p.default)("getEntries")()}render(e,{loggedIn:t,loading:n,entryIndex:c,entry:d,entries:f,entryReady:p}){return(0,r.h)("div",{id:"main-wrapper"},(0,r.h)("div",{id:"view-wrapper"},(0,r.h)("main",{id:"main"},(0,r.h)(i.default,null),(0,r.h)(o.Router,{onChange:h.handleRouteChange.bind(this)},(0,r.h)(a.default,{path:"/",loggedIn:t,loading:n}),(0,r.h)(u.default,{path:"/entries",loggedIn:t,loading:n,entries:f}),(0,r.h)(s.default,{path:"/entry/:id",loggedIn:t,loading:n,entryIndex:c,entry:d,entryReady:p}),(0,r.h)(l.default,{default:!0})))))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o=n(0),i=n(10),a=n(1),u=(r=a)&&r.__esModule?r:{default:r};t.default=class extends o.Component{render(){return(0,o.h)("header",null,(0,o.h)("h1",null,"Journalize"),(0,o.h)("nav",null,(0,o.h)(i.Link,{href:"/entries"},"Entries"),(0,o.h)(i.Link,{href:"/entry/new"},"Create"),(0,o.h)(i.Link,{href:"#",onClick:(0,u.default)("logout")},"Logout")))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Link=t.Match=void 0;var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},o=n(0),i=n(2);function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var u=t.Match=function(e){function t(){var n,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,i=Array(o),u=0;u<o;u++)i[u]=arguments[u];return n=r=a(this,e.call.apply(e,[this].concat(i))),r.update=function(e){r.nextUrl=e,r.setState({})},a(r,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.componentDidMount=function(){i.subscribers.push(this.update)},t.prototype.componentWillUnmount=function(){i.subscribers.splice(i.subscribers.indexOf(this.update)>>>0,1)},t.prototype.render=function(e){var t=this.nextUrl||(0,i.getCurrentUrl)(),n=t.replace(/\?.+$/,"");return this.nextUrl=null,e.children[0]&&e.children[0]({url:t,path:n,matches:n===e.path})},t}(o.Component),s=function(e){var t=e.activeClassName,n=e.path,a=function(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}(e,["activeClassName","path"]);return(0,o.h)(u,{path:n||a.href},function(e){var n=e.matches;return(0,o.h)(i.Link,r({},a,{class:[a.class||a.className,n&&t].filter(Boolean).join(" ")}))})};t.Link=s,t.default=u,u.Link=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o=n(0),i=n(1),a=(r=i)&&r.__esModule?r:{default:r};t.default=class extends o.Component{constructor(...e){var t;return t=super(...e),this.join=(e=>{e.preventDefault(),(0,a.default)("createAccount",{user:{username:this.base.querySelector("#cusername").value,password:this.base.querySelector("#cpassword").value}})()}),this.login=(e=>{e.preventDefault(),(0,a.default)("login",{user:{username:this.base.querySelector("#lusername").value,password:this.base.querySelector("#lpassword").value}})()}),t}render(){return(0,o.h)("div",{class:"login-page-wrapper"},(0,o.h)("h1",{class:"center-text"},"Journalize"),(0,o.h)("h4",{class:"center-text"},"Private and public journal entries"),(0,o.h)("form",{action:"javscript:",onSubmit:this.join,class:"join-form pure-form pure-form-stacked full-width"},(0,o.h)("fieldset",null,(0,o.h)("legend",null,"Create an Account"),(0,o.h)("input",{id:"cusername",placeholder:"username",autocapitalize:"off"}),(0,o.h)("input",{id:"cpassword",type:"password",placeholder:"password"}),(0,o.h)("input",{type:"submit",class:"pure-button pure-button-primary"}))),(0,o.h)("form",{action:"javascript:",onSubmit:this.login,class:"login-form pure-form pure-form-stacked full-width"},(0,o.h)("fieldset",null,(0,o.h)("legend",null,"or Login"),(0,o.h)("input",{id:"lusername",placeholder:"username",autocapitalize:"off"}),(0,o.h)("input",{id:"lpassword",type:"password",placeholder:"password"}),(0,o.h)("input",{type:"submit",class:"pure-button pure-button-primary"}))))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o=n(0),i=n(13),a=(r=i)&&r.__esModule?r:{default:r};t.default=class extends o.Component{render({entries:e}){return e=e||[],(0,o.h)("entry-list",null,e.map(e=>(0,o.h)(a.default,{entry:e})))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=class extends r.Component{render({entry:e}){return e.deleted||e.newEntry&&!e.postPending?"":(0,r.h)("div",{class:"entry-preview"},(0,r.h)("a",{class:"entry-link",href:"/entry/"+e.id},e.date),(0,r.h)("span",null,e.isPublic?"🔓":"🔐"),"✖",(0,r.h)("p",{class:"entry-text"},e.text.length>140?e.text.substr(0,140)+"...":e.text))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o=a(n(1)),i=a(n(3));function a(e){return e&&e.__esModule?e:{default:e}}t.default=class extends r.Component{constructor(...e){var t;return t=super(...e),this.upsert=(e=>{var t=this.props.entry;t.newEntry?(t.date=this.base.querySelector("#entryDate").innerText,t.text=this.base.querySelector("#entryText").innerText,t.isPublic=this.base.querySelector("#isPublic").checked,(0,o.default)("createEntry",{entry:t})()):this.update(e)}),this.update=(e=>{var t;switch(e.target.nodeName){case"H1":t="date";break;case"PRE":t="text"}var n={property:t,entryId:this.props.entry.id,entry:{}};n.entry[t]=e.target.innerText,(0,o.default)("updateEntry",n)()}),this.togglePublic=(e=>{var t={property:"isPublic",entryId:this.props.entry.id,entry:{isPublic:this.base.querySelector("#isPublic").checked}};(0,o.default)("updateEntry",t)()}),t}shouldComponentUpdate(e,t){var n=this.props.entry,r=e.entry;return!n||!r||r.date!==n.date||r.text!==n.text.trim()||r.isPublic!==n.isPublic}render({entryIndex:e,entry:t,entryReady:n}){if(n)return t?(0,r.h)("entry-view",null,(0,r.h)("h1",{id:"entryDate",contenteditable:!0,onInput:this.upsert},t.date),"Public ",(0,r.h)("input",{id:"isPublic",type:"checkbox",onClick:this.togglePublic,checked:t.isPublic}),(0,r.h)("button",{onClick:(0,o.default)("deleteEntry",{id:t.id})},"Delete"),(0,r.h)("pre",{id:"entryText",contenteditable:!0,onInput:this.upsert,class:"entry-text"},t.text)):(0,r.h)(i.default,null)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){Object.keys(t).forEach(n=>{let r=t[n].bind(this,e);document.addEventListener(n,r)})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={get:function(e){for(var t=e+"=",n=document.cookie.split(";"),r=0;r<n.length;r++){for(var o=n[r];" "==o.charAt(0);)o=o.substring(1,o.length);if(0==o.indexOf(t))return o.substring(t.length,o.length)}return null}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(n(18)),o=i(n(20));function i(e){return e&&e.__esModule?e:{default:e}}t.default=Object.assign(r.default,o.default)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(n(19)),o=n(2),i=a(n(4));function a(e){return e&&e.__esModule?e:{default:e}}const u=function(e,t){e.setState(Object.assign(e.state,{loggedIn:!0,loading:e.state.loading-1}),function(){(0,o.route)("/entries")})},s=function(e,t){e.setState({loading:e.state.loading-1}),console.log("loginFailure",t)},l=function(e,t){e.setState({loading:e.state.loading-1}),(0,o.route)("/entries")},c=function(e,t){e.setState({loading:e.state.loading-1}),console.log("createAccountFailure",t)},d=function(e){localStorage.clear(),e.setState((0,i.default)()),(0,o.route)("/")},f=function(e,t){e.setState({loading:e.state.loading-1}),console.log("logoutFailure",t)};t.default={login:function(e,t){localStorage.clear(),e.setState({loading:e.state.loading+1});let n=t.detail.user;r.default.login(n).then(t=>{u(e,t)}).catch(t=>{s(e,t)})},createAccount:function(e,t){localStorage.clear(),e.setState({loading:e.state.loading+1});let n=t.detail.user;r.default.create(n).then(t=>{l(e,t)}).catch(t=>{c(e,t)})},logout:function(e,t){e.setState({loading:e.state.loading+1}),r.default.logout().then(()=>{d(e)}).catch(t=>{f(e,t)})}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o=n(5),i=(r=o)&&r.__esModule?r:{default:r};t.default={create:function(e){return(0,i.default)("/api/user",{method:"POST",body:e})},login:function(e){return(0,i.default)("/api/user/login",{method:"POST",body:e})},logout:function(){return(0,i.default)("/api/user/logout",{method:"POST"})}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=s(n(21)),o=n(2),i=s(n(22)),a=n(6),u=s(n(23));function s(e){return e&&e.__esModule?e:{default:e}}let l=!1;const c=function(e){e.state.entries||(e.setState({loading:e.state.loading+1}),r.default.getAll().then(t=>{d(e,t)}).catch(t=>{f(e,t)}))},d=function(e,t){(0,u.default)(e,{entries:t.entries,loading:e.state.loading-1},function(){M(e,{detail:{id:e.state.entryId,entryReady:!0}}),localStorage.setItem("timestamp",t.timestamp)})},f=function(e,t){e.setState({loading:e.state.loading-1}),console.log("getAllEntriesError",t)},p=function(e,t){e.setState({loading:e.state.loading+1}),r.default.sync(t.detail.timestamp).then(t=>{h(e,t)}).catch(t=>{g(e,t)}),function(e){e.state.entries.forEach(t=>{t.needsSync&&(t.newEntry?m:t.deleted?P:w)(e,{detail:{id:t.id,entry:t,clientSync:!0}})})}(e)},h=function(e,t){if(0===t.entries.length)return e.setState({loading:e.state.loading-1}),void localStorage.setItem("timestamp",t.timestamp);y(e,t.entries),v(e,t.timestamp)},y=function(e,t){t.forEach((t,n)=>{var r=(0,a.findObjectIndexById)(t.id,e.state.entries);r>-1?t.deleted?e.state.entries=(0,a.removeObjectByIndex)(r,e.state.entries):e.state.entries[r]=t:e.state.entries.unshift(t)})},v=function(e,t){(0,u.default)(e,{loading:e.state.loading-1,entries:[].concat(e.state.entries)},function(){"/entry"===e.view&&e.state.entryId&&M(e,{detail:{id:e.state.entryId,entryReady:!0}}),localStorage.setItem("timestamp",t)})},g=function(e,t){e.setState({loading:e.state.loading-1}),console.log("syncEntriesFailure",t)},m=function(e,t){let n=t.detail.entry;var o=(0,a.findObjectIndexById)(n.id,e.state.entries);e.state.entries[o]=n,(0,u.default)(e,{loading:e.state.loading+1,entry:n,entries:[].concat(e.state.entries)}),!t.detail.clientSync&&n.postPending||(e.state.entries[o].postPending=!0,(0,u.default)(e,{entries:[].concat(e.state.entries)}),r.default.create(n).then(t=>{_(e,n.id,t)}).catch(t=>{x(e,n.id,t)}))},b=(0,i.default)(m,500),_=function(e,t,n){var r=(0,a.findObjectIndexById)(t,e.state.entries);e.state.entry.id===t&&(e.state.entry.id=n.id),e.state.entries[r].id=n.id,delete e.state.entries[r].postPending,delete e.state.entries[r].newEntry,delete e.state.entries[r].needsSync,(0,u.default)(e,{loading:e.state.loading-1,entry:Object.assign({},e.state.entry),entries:[].concat(e.state.entries)})},x=function(e,t){var n=(0,a.findObjectIndexById)(oldId,e.state.entries);delete e.state.entries[n].postPending,e.setState({loading:e.state.loading-1,entries:[].concat(e.state.entries)}),console.log("slowCreateFailure",t)},C=(0,i.default)(function(e,t){var n=t.detail,o=n.entry[n.property];"string"==typeof o&&(o=o.trim()),n.entry[n.property]=n.entry[n.property];var i=(0,a.findObjectIndexById)(n.entryId,e.state.entries);e.state.entries[i][n.property]!==n.entry[n.property]&&(e.state.entries[i][n.property]=n.entry[n.property],e.state.entries[i].needsSync=!0,(0,u.default)(e,{entry:Object.assign({},e.state.entries[i]),entries:[].concat(e.state.entries)}),r.default.update(n.entryId,n.entry).then(function(){S(e,n.entryId)}).catch(function(t){O(e,t)}))},500),S=function(e,t){var n=(0,a.findObjectIndexById)(t,e.state.entries);delete e.state.entries[n].needsSync,(0,u.default)(e,{entry:Object.assign({},e.state.entries[n]),entries:[].concat(e.state.entries)})},O=function(e,t){console.log("slowUpdateFailure",t)},w=function(e,t){var n=t.detail.entry;r.default.update(n.id,n).then(function(){S(e,n.id)}).catch(function(t){O(e,t)})},P=function(e,t){var n=t.detail.id;if(n){var i=(0,a.findObjectIndexById)(n,e.state.entries);e.state.entries[i].needsSync=!0,e.state.entries[i].deleted=!0,(0,u.default)(e,{entry:void 0,entries:[].concat(e.state.entries)},function(){(0,o.route)("/entries")}),r.default.del(n).then(function(){j(e,n)}).catch(t=>{I(e,t)})}},j=function(e,t){var n=(0,a.findObjectIndexById)(t,e.state.entries);(0,u.default)(e,{entries:(0,a.removeObjectByIndex)(n,e.state.entries)})},I=function(e,t){console.log("deleteEntryFailure",t)},M=function(e,t){if(e.state.entries&&t&&t.detail&&t.detail.id&&-1!==t.detail.id){var n=(0,a.findObjectIndexById)(parseInt(t.detail.id,10),e.state.entries),r=e.state.entries[n],o=!!r||!!t.detail.entryReady;e.setState({entry:r,entryIndex:n,entryReady:o})}};t.default={getEntries:function(e,t){if(!e.state.loggedIn)return l=!1;if(l)return;l=!0;let n=localStorage.getItem("timestamp");n?p(e,{detail:{timestamp:n}}):c(e)},createEntry:b,getEntry:function(e,t){},updateEntry:C,deleteEntry:P,setEntry:M,newEntry:function(e){var t={id:Date.now(),date:(new Date).toISOString().slice(0,10),text:"",isPublic:0,needsSync:!0,newEntry:!0};e.setState({entryIndex:0,entries:[t].concat(e.state.entries)},function(){M(e,{detail:{id:t.id,entryReady:!0}})})}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o=n(5),i=(r=o)&&r.__esModule?r:{default:r};t.default={create:function(e){return(0,i.default)("/api/entry",{method:"POST",body:e})},get:function(e){return(0,i.default)("/api/entry/"+entry.id)},update:function(e,t){return(0,i.default)("/api/entry/"+e,{method:"PATCH",body:t})},del:function(e){return(0,i.default)("/api/entry/"+e,{method:"DELETE"})},getAll:function(){return(0,i.default)("/api/entries")},sync:function(e){return(0,i.default)("/api/entries/sync/"+e)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){var r;return function(){var o=this,i=arguments,a=n&&!r;clearTimeout(r),r=setTimeout(function(){r=null,n||e.apply(o,i)},t),a&&e.apply(o,i)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){e.setState(t,n),t.entries&&localStorage.setItem("entries",JSON.stringify(t.entries))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.handleRouteChange=function(e){var t=e.url.lastIndexOf("/")>0?e.url.substr(0,e.url.lastIndexOf("/")):e.url;if(this.view=t,"/"!==t&&!this.state.loggedIn)return route("/");s.call(this,t,e)};var r,o=n(1),i=(r=o)&&r.__esModule?r:{default:r},a=n(6);let u=history.pushState;history.pushState=((e,t,n)=>{u.call(history,e,t,n),scrollTo(0,0)});const s=function(e,t){switch(e){case"/":l.call(this,t);break;case"/entries":c.call(this,t);break;case"/entry":d.call(this,t)}},l=function(e){this.state.loggedIn&&route("/entries")},c=function(e){if(Array.isArray(this.state.entries)){var t=this.state.entries[0];t.newEntry&&!t.text&&this.setState({entries:(0,a.removeObjectByIndex)(0,this.state.entries)})}},d=function(e){var t;try{t=e.current.attributes.id}catch(e){}t&&("new"===t?(0,i.default)("newEntry")():(0,i.default)("setEntry",{id:t})())}}]);